ERASE
* ENABLE FILE LOCKING
POKE 8,1
SET TALK OFF
* SET USEFILE TO NULL FILE
STORE ' ' TO USEFILE
* SET OPEN FLAGS TO FALSE
STORE 0 TO OPEN:P
STORE 0 TO OPEN:S
* INIT LOCK FLAGS
STORE 0 TO LOCK:P
STORE 0 TO LOCK:S
* START WITH DEFAULT SETTINGS
STORE 'A:' TO DBFDRIVE:P
STORE 'A:' TO DBFDRIVE:S
STORE 0 TO IFLAG
* THE PRIMARY & SECONDARY DRIVES CANNOT BE THE SAME
DO WHILE DBFDRIVE:P = DBFDRIVE:S
  IF IFLAG <> 0
    ? CHR(7),'THE DRIVES CANNOT BE THE SAME. TRY AGAIN'
  ENDIF
* IFLAG IS A TEMPORARY 1-SHOT FLAG
  STORE 1 TO IFLAG
  STORE -1 TO OKF
  DO WHILE OKF <> 0
    ACCEPT 'ENTER DRIVE FOR PRIMARY FILES' TO DBFDRIVE:P
    IF LEN(DBFDRIVE:P) = 2 .AND. $(DBFDRIVE:P,2,1) = ':'
      STORE 0 TO OKF
    ELSE
      * DBFDRIVE MUST CONTAIN 2 CHRS, A LETTER & A COLON!!
      ? CHR(7),'ILLEGAL DRIVE, TRY AGAIN'
    ENDIF
  ENDDO
  STORE -1 TO OKF
  DO WHILE OKF <> 0
    ACCEPT 'ENTER DRIVE FOR SECONDARY FILES' TO DBFDRIVE:S
    IF LEN(DBFDRIVE:S) = 2 .AND. $(DBFDRIVE:S,2,1) = ':'
      STORE 0 TO OKF
    ELSE
      * DBFDRIVE MUST CONTAIN 2 CHRS, A LETTER & A COLON!!
      ? CHR(7),'ILLEGAL DRIVE, TRY AGAIN'
    ENDIF
  ENDDO
ENDDO
RELEASE IFLAG
ERASE
